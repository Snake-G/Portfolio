<center>

# Определение жанра музыкального трека.
</center>

Музыкальный стриминговый сервис расширяет работу с новыми артистами и музыкантами, 
в связи с чем возникла задача - правильно классифицировать новые музыкальные треки, 
чтобы улучшить работу рекомендательной системы. 


### Что надо сделать?
- **Задача** - разработать модель, позволяющую классифицировать музыкальные произведения по жанрам. <br><br>
- **Метрика** - необходимо максимизировать метрику `F1-score` и оценить по ней качество алгоритма.


### В ходе предобработки данных выполнено:
- проверка и удаление дубликатов;
- удаление колонок, не несущих в себе смысловой нагрузки для достижения целей обучения моделей;
- удаление колонки с датой добавления музыкального трека и именем композиции;
- обнаруженные в колонке звучания минусовые значения заполнены медианным значением данной колонки;
- устранены пропуски в колонках ключа, моды и темпа;
- произведено кодирование и масштабирование данных.


### Ключевые шаги: 
- подготовка синтетического признака из длины имени музыкального произведения. Введение этого признака существенно улучшило показатели метрики модели.
- подготовка pipeline;
- проверена работоспособность различных методов подбора гиперпараметров. Для подбора применялись:
  - *RandomizedSearchCV*,
  - *HalvingRandomSearchCV*,
  - *HalvingGridSearchCV*,
  - *Optuna* 
- *Optuna* показала наилучшее быстродействие и лучшие показатели в целевой метрике в сравнении с остальными средствами подбора;
- сборка стекинговой модели на основе всех, опробованных в задаче моделей.


### В работе были использованы модели:
- **AdaBoostClassifier**,
- **RandomForestClassifier**,
- **CatBoostClassifier**,
- **GradientBoostingClassifier**,
- **LGBMClassifier**,
- **ExtraTreesClassifier**.


### Вывод
Наилучшие показатели метрики показала модель на основе ***LGBMClassifier***, `F1_micro=0.50131`. 
Второе место досталось модели на основе ***CatBoostClassifier***, `F1_micro=0,500302480338778`. 
Итоговой моделью была выбрана стекинговая модель. Ее показатели результирующей метрики 
оказались выше, чем у всех остальных моделей на тренировочной выборке. 
(`F1_micro=0.5638233514821537`). Таким образом мне удалось получить модель, способную с 
вероятностью более 50% классифицировать жанр нового музыкального произведения.
